<?xml version="1.0" encoding="utf-8"?>

<mechanics book="3">

    <!-- LIST OF TRANSLATED IMAGES -->
    <translated-images>
        <image>map.png</image>
        <image>weapons.png</image>
    </translated-images>

    <!-- GAME RULES -->
    <sections>

        <section id="tssf">
            <!-- Drop the previous books map -->
            <drop objectId="map" />
            <!-- Hunt is not available on Kalte (see section "equipmnt") -->
            <huntStatus enabled="false" />
        </section>

        <section id="gamerulz">
            <!-- Select the player skills (weapons skill and endurance) UI -->
            <setSkills />
        </section>

        <section id="discplnz">
            <!-- Select the Kai disciplines UI -->
            <setDisciplines />
        </section>

        <section id="equipmnt">
            <!-- Do not pick 2 maps! -->
            <test not="true" hasObject="map" >
                <pick objectId="map" />
            </test>

            <randomTable>
                <pick class="money" count="[RANDOM] + 10" />
            </randomTable>

            <object objectId="sword" />
            <object objectId="shortsword" />
            <object objectId="leatherwaistcoat" />
            <object objectId="spear" />
            <object objectId="mace" />
            <object objectId="warhammer" />
            <object objectId="axe" />
            <object objectId="laumspurpotion4" />
            <object objectId="quarterstaff" />
            <object objectId="meal" />
            <object objectId="broadsword" />

            <message en-text="Pick the money and choose two objects before continue" />
        </section>

        <section id="sect4">
            <object objectId="bonesword" />
            <object objectId="bluestonedisc" />
        </section>

        <section id="sect8">
            <pick objectId="baknaroil" />
        </section>

        <section id="sect9">
            <death />
        </section>

        <section id="sect10">
            <test sectionVisited="sect90">
                <choiceState section="sect90" set="disabled" />
            </test>
            <test sectionVisited="sect171">
                <choiceState section="sect171" set="disabled" />
            </test>
            <test sectionVisited="sect289">
                <choiceState section="sect289" set="disabled" />
            </test>
            <test sectionVisited="sect225">
                <choiceState section="sect225" set="disabled" />
            </test>
            <object objectId="backpack" />
        </section>

        <section id="sect12">
            <pick objectId="meal" index="0" />
            <pick objectId="meal" index="1" />
            <!-- You pick 3 and eat one, so no third -->
            <!--pick objectId="meal" index="2" /-->
            <pick objectId="sleepingfurs" />
            <pick objectId="rope" />
        </section>

        <section id="sect14">
            <choiceState section="all" set="disabled" />
            <afterCombats>
                <choiceState section="all" set="enabled" />
            </afterCombats>
        </section>

        <section id="sect15">
            <test not="true" hasDiscipline="mindomtr">
                <choiceState section="sect185" set="disabled" />
            </test>
            <test not="true" hasObject="bonesword|bonedagger">
                <choiceState section="sect86" set="disabled" />
            </test>
            <test hasDiscipline="mindomtr" hasObject="bonesword|bonedagger">
                <choiceState section="sect323" set="disabled" />
            </test>
        </section>

        <section id="sect16">
            <message id="msg-drop-object" en-text="Drop two backpack items before continue" />
            <choiceState section="all" set="disabled" />
            <onInventoryEvent>
                <test expression="[BACKPACK-ITEMS-CNT-ON-ACTIONCHART] == 0 || [BACKPACK-ITEMS-CNT-ON-SECTION] >= 2">
                    <message id="msg-drop-object" op="hide" />
                    <choiceState section="all" set="enabled" />
                </test>
                <test not="true" expression="[BACKPACK-ITEMS-CNT-ON-ACTIONCHART] == 0 || [BACKPACK-ITEMS-CNT-ON-SECTION] >= 2">
                    <message id="msg-drop-object" op="show" />
                    <choiceState section="all" set="disabled" />
                </test>
            </onInventoryEvent>
        </section>

        <!-- UP TO SECTION 17 -->
    </sections>

</mechanics>